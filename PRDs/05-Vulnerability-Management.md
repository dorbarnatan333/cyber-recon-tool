# PRD: Vulnerability Management

## Overview
Comprehensive vulnerability tracking and management system for discovered security issues. Provides CVE database, risk assessment, remediation guidance, and vulnerability lifecycle management.

## Purpose
Enable security analysts to track, prioritize, and remediate vulnerabilities discovered across all targets. Integrates CVE information, CVSS scoring, exploit availability, and remediation guidance in a centralized vulnerability management interface.

---

## Requirements

### REQ-VULN-001: Vulnerability Statistics Dashboard

**Title**: Display Vulnerability Overview Statistics

**Description**:
Show five key metrics summarizing the vulnerability landscape: total vulnerabilities, critical count, high severity count, open issues, and new discoveries this week.

**Acceptance Criteria**:
- Display 5 statistic cards in responsive grid (1 column mobile → 5 columns desktop)
- Card 1: Total Vulnerabilities
  - Count of all vulnerabilities
  - Icon: Database
  - Color: Gray border
- Card 2: Critical
  - Count of critical severity vulnerabilities
  - Icon: AlertTriangle
  - Color: Red/danger border
- Card 3: High Severity
  - Count of high severity vulnerabilities
  - Icon: Shield
  - Color: Orange/warning border
- Card 4: Open Issues
  - Count of vulnerabilities with status 'open'
  - Icon: Target
  - Color: Red/danger border
- Card 5: New This Week
  - Count of recently discovered vulnerabilities
  - Icon: TrendingUp
  - Color: Blue/info border
- Statistics calculated from vulnerabilities array

**Technical Implementation**:
- Card components with solid variant and colored left borders (4px)
- Grid layout with 5 columns on desktop
- Statistics calculations:
  - Total: vulnerabilities.length
  - Critical: filter by severity === 'critical'
  - High: filter by severity === 'high'
  - Open: filter by status === 'open'
  - New: filter by discoveredAt in last 7 days or custom logic
- Icons from icon library with consistent sizing

---

### REQ-VULN-002: Vulnerability Filter Tabs

**Title**: Create Tab Navigation for Vulnerability Filtering

**Description**:
Provide tab interface to filter vulnerabilities by common criteria: All, Critical, Open, and Recent.

**Acceptance Criteria**:
- Four tabs displayed horizontally:
  1. "All Vulnerabilities" - Shows all vulnerabilities with count
  2. "Critical" - Shows only critical severity with count
  3. "Open" - Shows only open status with count
  4. "Recent" - Shows recent discoveries with count
- Active tab styling:
  - Primary background color
  - Primary border
  - Accent text color
- Inactive tab styling:
  - Transparent background
  - Gray text
  - Hover effect
- Clicking tab filters vulnerability table
- Tab bar has dark background container with rounded corners
- Count badges displayed in tab labels

**Technical Implementation**:
- State variable for active tab ('all' | 'critical' | 'open' | 'recent')
- Tab buttons with conditional className based on active state
- onClick handlers update active tab state
- Filter logic applied to vulnerabilities array based on active tab
- Tab data array with key, label, and count
- Smooth transition between tab states

---

### REQ-VULN-003: Search and Action Bar

**Title**: Implement Search, Filter, and Export Controls

**Description**:
Provide toolbar with search input, filter button, and export report action.

**Acceptance Criteria**:
- Left section:
  - Tab navigation (from REQ-VULN-002)
  - Filter button with Filter icon
- Right section:
  - Search input: placeholder "Search vulnerabilities..."
  - Export button: "Export Report" with Download icon, secondary variant
- Search input width ~256px
- Filter button shows filters panel or modal (can be placeholder)
- Export button triggers report generation (can be placeholder)
- Bar positioned between statistics and table

**Technical Implementation**:
- Flex container with space-between layout
- Left section: Tabs and filter button in horizontal layout
- Right section: Search input and export button with gap
- Search input component with onSearch callback
- Filter button with ghost variant, small size
- Export button with secondary variant, small size
- Search callback updates filter state or query string
- Export handler logs action or triggers download

---

### REQ-VULN-004: Vulnerabilities Table

**Title**: Display Comprehensive Vulnerability Table

**Description**:
Show all vulnerabilities in table format with columns for CVE ID, title, severity, CVSS score, status, affected targets, discovery time, and exploit availability.

**Acceptance Criteria**:
- Card container with header showing filtered count
- Table columns:
  - Vulnerability (CVE badge, title)
  - Severity (threat badge)
  - CVSS (score with color coding)
  - Status (icon + text)
  - Affected Targets (badge list, max 2 shown + count)
  - Discovered (relative time)
  - Exploit (badge if available)
  - Actions (view, mark fixed)
- CVSS score color coding:
  - 9.0-10.0: Red/danger
  - 7.0-8.9: Orange/warning
  - 4.0-6.9: Yellow/info
  - 0.0-3.9: Gray
- Status icons:
  - Open: AlertCircle (red)
  - Investigating: Search (orange)
  - Mitigated: CheckCircle (green)
  - False Positive: Info (gray)
- Exploit badge:
  - Text: "Available"
  - Danger variant with pulse animation
  - Only shown if exploit.available === true
- Row click opens vulnerability details panel
- Rows have hover effect
- Action menu includes:
  - Mark as Fixed
  - View CVE Details (external link)

**Technical Implementation**:
- Card with glass variant
- Table component with defined columns
- Vulnerability data structure (see Data Requirements)
- CVE badge component displaying ID and score
- Threat/severity badge component
- Status icon helper function mapping status to icon and color
- CVSS score with conditional color classes
- Affected targets as badge array, slice to first 2, show +N for remainder
- Exploit badge with danger variant and pulse animation
- Row onClick handler to set selected vulnerability
- Action cell with callbacks for mark fixed and view CVE
- Hover background highlight for rows

---

### REQ-VULN-005: Vulnerability Details Panel

**Title**: Display Detailed Vulnerability Information

**Description**:
Show expandable panel with comprehensive vulnerability details including description, remediation, references, technical info, affected assets, and exploit information.

**Acceptance Criteria**:
- Panel appears above table when vulnerability selected
- Card with glass variant and warning/accent glow
- Header section:
  - Vulnerability title (large heading)
  - CVE badge, severity badge, category badge
  - Close button (X) on right
- Content in two-column layout (desktop):
  - Left column (2/3 width):
    - Description section
    - Remediation section (if available)
    - References section with external links
  - Right column (1/3 width):
    - Technical Details (CVSS score, vector, source, discovered date)
    - Affected Assets list
    - Exploit Information (if available)
- References as clickable links with external link icon
- Technical details as key-value pairs
- Exploit info shows: Available (yes/no badge), Complexity, Public Exploits count
- Panel dismissible by clicking close button
- Single column stack on mobile

**Technical Implementation**:
- Conditional rendering based on selectedVuln state
- Card container with glass variant and glow
- Header with flex layout, space-between
- Close button onClick handler clears selectedVuln
- Grid layout: 1 column mobile → 2 columns (2/3 + 1/3) desktop
- Section headers with medium font weight
- Description and remediation as paragraph text
- References as anchor tags with target="_blank" and rel="noopener noreferrer"
- Technical details as key-value list with appropriate spacing
- Affected assets as list of target names/IPs
- Exploit info as key-value pairs with conditional badge for availability
- Badge variants for yes/no indication

---

### REQ-VULN-006: Page Header with Refresh Controls

**Title**: Create Page Header with Title and Refresh Action

**Description**:
Display page header with title, description, last scan time, and refresh button.

**Acceptance Criteria**:
- Header section contains:
  - Left: Title "Vulnerability Management" (large heading)
  - Left: Description "Track, analyze, and remediate security vulnerabilities across your infrastructure"
  - Right: Last scan indicator with Clock icon and time
  - Right: "Refresh Data" button with RefreshCw icon, secondary variant
- Header layout: Text on left, controls on right
- Last scan shows relative time (e.g., "Last scan: 30 minutes ago")
- Refresh button triggers data reload (can be placeholder)

**Technical Implementation**:
- Flex container with space-between layout
- Left section: Title and description with vertical stack
- Right section: Last scan text and refresh button with horizontal layout and gap
- Clock icon with small size
- Refresh button with secondary variant, small size
- onClick handler for refresh (can log to console or trigger data fetch)
- Last scan time as state variable or static for demo

---

### REQ-VULN-007: CVE Badge Component

**Title**: Display CVE ID with CVSS Score Badge

**Description**:
Show CVE identifier and CVSS score in compact badge format with color coding.

**Acceptance Criteria**:
- Badge displays: CVE ID (e.g., "CVE-2023-1234")
- Badge includes CVSS score indicator
- Color coding based on CVSS score:
  - 9.0-10.0: Red/danger
  - 7.0-8.9: Orange/warning
  - 4.0-6.9: Yellow/info
  - 0.0-3.9: Gray/low
- Compact size for inline display
- Clickable to show details or link to CVE database

**Technical Implementation**:
- Badge component with CVE ID text and score display
- Props: cveId (string), score (number)
- Conditional color variant based on score ranges
- Small or extra-small size
- Optional onClick handler for click actions
- Can be link or button element

---

### REQ-VULN-008: Vulnerability Status Indicators

**Title**: Display Vulnerability Lifecycle Status

**Description**:
Show current status of vulnerability with appropriate icon and color: Open, Investigating, Mitigated, False Positive.

**Acceptance Criteria**:
- Four status types:
  - Open: AlertCircle icon, red color, "Open" text
  - Investigating: Search icon, orange color, "Investigating" text
  - Mitigated: CheckCircle icon, green color, "Mitigated" text
  - False Positive: Info icon, gray color, "False Positive" text
- Status displayed as icon + text in table
- Status badge or label in details panel
- Capitalized text with spaces (e.g., "False Positive" not "false-positive")

**Technical Implementation**:
- Helper function mapping status to icon component
- Helper function mapping status to color class
- Status rendering as flex layout with icon and text
- Icon size ~16px in table
- Color classes for text matching icon color
- Status string transformation: replace hyphens, capitalize

---

### REQ-VULN-009: Affected Targets Display

**Title**: Show List of Affected Targets/Assets

**Description**:
Display which targets are affected by each vulnerability in both table and detail views.

**Acceptance Criteria**:
- Table view:
  - Show first 2 affected targets as badges
  - If more than 2, show "+N" badge for additional count
  - Badges use secondary variant
  - Small size badges
- Detail panel view:
  - Show all affected targets as list
  - Target names/IPs in monospace font
  - Each target on separate line
- Empty state if no affected targets

**Technical Implementation**:
- Table: Slice affected targets array to first 2
- Map to badge components
- Additional count badge if length > 2
- Detail panel: Map all targets to list items or div elements
- Monospace font class for target identifiers
- Badge component with secondary variant and small size

---

### REQ-VULN-010: Exploit Information Display

**Title**: Show Exploit Availability and Details

**Description**:
Display information about exploit availability, complexity, and public exploit count.

**Acceptance Criteria**:
- Table view:
  - "Available" badge if exploit.available === true
  - Danger variant with pulse animation
  - Hidden if no exploit or not available
- Detail panel view (if exploit data exists):
  - Available: Yes/No badge (danger for yes, success for no)
  - Complexity: Low/Medium/High (capitalized text)
  - Public Exploits: Count number
  - Displayed as key-value pairs
- Exploit section only shown if exploit object exists

**Technical Implementation**:
- Conditional rendering based on exploit object and available boolean
- Table: Badge component with danger variant and pulse animation
- Detail panel: Key-value list layout
- Badge for available status with conditional variant
- Text display for complexity and count
- Section header: "Exploit Information"
- Hide entire section if no exploit data

---

### REQ-VULN-011: References and External Links

**Title**: Display CVE References with External Links

**Description**:
Show list of reference URLs for vulnerability research and remediation.

**Acceptance Criteria**:
- Section header: "References"
- Each reference displayed as clickable link
- External link icon next to URL
- Links open in new tab with security attributes
- Primary/accent color for links
- Hover effect (color change)
- Links show full URL or truncated with tooltip
- Empty state if no references

**Technical Implementation**:
- Section with references array map
- Anchor elements with:
  - href={reference}
  - target="_blank"
  - rel="noopener noreferrer"
  - className for primary color
- External link icon component (small size)
- Hover color transition
- Vertical list layout with spacing
- Conditional rendering if references.length > 0

---

### REQ-VULN-012: Vulnerability Search and Filtering

**Title**: Implement Search and Filter Logic

**Description**:
Filter vulnerabilities based on search query and active tab selection.

**Acceptance Criteria**:
- Search matches:
  - CVE ID (case insensitive)
  - Vulnerability title (case insensitive)
- Tab filters:
  - All: Show all vulnerabilities
  - Critical: severity === 'critical'
  - Open: status === 'open'
  - Recent: discoveredAt within recent timeframe
- Combined filtering: Search AND tab filter
- Update displayed count when filters change
- Empty state if no matches

**Technical Implementation**:
- Filter state for search query and active tab
- Filter function applied to vulnerabilities array:
  - First apply tab filter
  - Then apply search filter on result
- Search comparison using toLowerCase() and includes()
- Filtered array used for table rendering
- Count display: `Showing {filtered.length} of {total.length} vulnerabilities`
- Empty state component if filtered array length === 0

---

## Data Requirements

**Vulnerability Structure**:
```typescript
{
  id: string,                    // 'vuln-001'
  cveId: string,                 // 'CVE-2023-34362'
  title: string,                 // 'Critical SQL Injection in MOVEit Transfer'
  description: string,           // Detailed description of vulnerability
  severity: 'low' | 'medium' | 'high' | 'critical',
  cvssScore: number,             // 9.8
  cvssVector: string,            // 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H'
  category: string,              // 'Injection', 'XSS', 'RCE', etc.
  affectedTargets: string[],     // ['web-server-01', '192.168.1.100']
  affectedPorts: number[],       // [80, 443, 8080]
  discoveredAt: string,          // '2 hours ago' or ISO timestamp
  status: 'open' | 'investigating' | 'mitigated' | 'false-positive',
  source: string,                // 'Vulnerability Scanner', 'Manual Testing'
  references: string[],          // ['https://nvd.nist.gov/...', ...]
  remediation?: string,          // Remediation guidance
  exploit?: {
    available: boolean,
    complexity: 'low' | 'medium' | 'high',
    publicExploits: number
  }
}
```

**Filter State**:
```typescript
{
  severity: string[],        // ['critical', 'high']
  status: string[],          // ['open', 'investigating']
  category: string[],        // ['Injection', 'XSS']
  searchQuery: string        // User search text
}
```

**Statistics Calculation**:
```typescript
{
  total: vulnerabilities.length,
  critical: vulnerabilities.filter(v => v.severity === 'critical').length,
  high: vulnerabilities.filter(v => v.severity === 'high').length,
  open: vulnerabilities.filter(v => v.status === 'open').length,
  newThisWeek: 3  // Custom logic or filter
}
```

## Notes
- All vulnerability data is mock/demo - integrate with vulnerability scanning APIs in production
- CVE references should link to NVD, MITRE, or vendor security advisories
- CVSS vector parsing could be enhanced to show visual breakdown
- Remediation guidance can be fetched from CVE databases or custom knowledgebase
- Export functionality should generate PDF or CSV reports with vulnerability details
- Status transitions should be tracked for audit trail (future feature)
- Consider adding vulnerability timeline/history view
- Filter panel can expand to include date ranges, CVSS score ranges, affected asset filters
- Bulk operations (mark multiple as fixed, export selected) in future iterations
- Integration with ticketing systems (Jira, ServiceNow) for remediation tracking
- Exploit database integration for automatic exploit availability checking
